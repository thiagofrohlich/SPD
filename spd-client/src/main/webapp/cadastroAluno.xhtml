<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:tag="http://java.sun.com/jsf/composite/tags">
	
	<ui:composition template="/template.xhtml">
	
		<ui:define name="body">
		<div class="row">
                    <div class="col-lg-12">
			<div class="centralize">
			<div class="col-lg-12">
                    <h3 class="page-header">#{msg.cadastroAluno}</h3>
                </div>
                <h:form id="cadastro">
                	<div class="col-lg-12">
                	<p:messages id="messageAluno" autoUpdate="true" showDetail="true" closable="true"/>
                		<p:panelGrid  styleClass="noborder centralize">
                			<p:row>
								<p:column styleClass="labelForm">
									<h:outputText value="#{msg.aluno}" />
								</p:column>
								<p:column>
									<p:inputText value="#{alunoBean.nome}" id="nome"/>
									 <p:commandButton value="#{msg.pesquisar}" action="#{alunoBean.buscaAluno()}" 
												onsuccess="PF('aluno').show();"	ajax="true" update=":cadastro:alunoTable" />
								</p:column>
							</p:row>
                		</p:panelGrid>
                	
                	<p:tabView id="formCadastro">
                		<p:tab title="#{msg.dadosGerais}">
                			<p:panelGrid  styleClass="noborder centralize" >
								<p:row>
									
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.ano_letivo}" />
									</p:column>
									<p:column>
										<p:calendar locale="pt_BR" mask="true" showButtonPanel="false"  value="#{alunoBean.aluno.anoletivo}" id="anoLetivo"
															pattern="dd/MM/yyyy" styleClass="inputDate" />
									</p:column>
			
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.primeira_matricula}" />
									</p:column>
									<p:column>
										<p:calendar locale="pt_BR" mask="true" showButtonPanel="false" value="#{alunoBean.aluno.anoinicio}" id="anoMatricula"
															pattern="dd/MM/yyyy" styleClass="inputDate" />
									</p:column>
									
								</p:row>
								
								<p:row>
			
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.nome}"  />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.nome}" id="nomeAluno"/>
									</p:column>

									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.dataNasc}" />
									</p:column>
									<p:column>
										<p:calendar locale="pt_BR" mask="true" showButtonPanel="false" value="#{alunoBean.aluno.datanasc}" id="datanasc"
															pattern="dd/MM/yyyy" styleClass="inputDate" />
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.modalidade}" />
									</p:column>
									<p:column>
										<p:selectOneMenu  value="#{alunoBean.modalidadeValue}" id="modalidade">
											<f:selectItem itemLabel="#{msg.selecione}" itemValue=""/>
											<f:selectItems value="#{alunoBean.modalidade}" var="moda" itemLabel="#{moda.descricao}" itemValue="#{moda.id}" />
										</p:selectOneMenu>
									</p:column>
			
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.periodo}" />
									</p:column>
									<p:column>
										<p:selectOneMenu  value="#{alunoBean.periodoValue}" id="periodo">
											<f:selectItem itemLabel="#{msg.selecione}" itemValue=""/>
											<f:selectItems value="#{alunoBean.periodo}" var="periodo" itemLabel="#{periodo.descricao}" itemValue="#{periodo.id}" />
										</p:selectOneMenu>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.nivel}" />
									</p:column>
									<p:column>
										<p:selectOneMenu  value="#{alunoBean.aluno.turma.id}">
											<f:selectItem itemLabel="#{msg.selecione}" itemValue=""/>
											<f:selectItems value="#{alunoBean.lstTurma}" var="lstTurma" itemLabel="#{lstTurma.descricao}" itemValue="#{lstTurma.id}" />
										</p:selectOneMenu>
									</p:column>
			
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.horario}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.horario}" id="horario"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.valor}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.valor}" id="valor" data-thousands="." data-decimal=","/>
									</p:column>
								</p:row>
							</p:panelGrid>
                		</p:tab>
                		
                		<p:tab title="#{msg.dadosMedicos}">
                			<p:panelGrid  styleClass="noborder centralize" >
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.intervCirurgicas}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.cirurgias}" id="cirurgias"/>
									</p:column>
			
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.possuiAlergia}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.alergia}" id="alergia"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.restAlimentar}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.restalimentar}" id="restAlimentar"/>
									</p:column>
			
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.temperamento}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.temperamento}" id="temperamento"/>
									</p:column>
								</p:row>
                			</p:panelGrid>
                		</p:tab>
                		
                		<p:tab title="#{msg.contatos}" >
                			<p:panelGrid  styleClass="noborder centralize" id="contato" >
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.casoEmergencia}" />
									</p:column>
									<p:column>
										<p:inputText />
									</p:column>
			
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.sitPais}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.sitpais}" id="sitPais"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm" >
										<h:outputText value="#{msg.responsavel}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.responsavel.nome}" />
									</p:column>
									<p:column styleClass="labelForm" >
										<h:outputText value="#{msg.parentesco}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.responsavel.parentesco}" />
										<p:commandButton ajax="true" action="#{alunoBean.incluiResponsavel()}" value="incluir" update="cadastro:formCadastro:contato cadastro:formCadastro:Tcontato" />
									</p:column>
									
								</p:row>
								</p:panelGrid>
								<p:panelGrid  styleClass="noborder centralize" id="Tcontato">
								<p:row>
									<p:column colspan="4" >
										<p:dataTable value="#{alunoBean.listaResponsavel}" var="lstResponsavel" styleClass="col-lg-12" >
											<p:column headerText="#{msg.nome}" styleClass="col-lg-5">
												<h:outputText value="#{lstResponsavel.nome}" />
											</p:column>
											
											<p:column headerText="#{msg.parentesco}" styleClass="col-lg-5">
												<h:outputText value="#{lstResponsavel.parentesco}" />
											</p:column>
											
											<p:column styleClass="col-lg-1">
												<p:commandButton ajax="true" action="#{alunoBean.deletaResponsavel(lstResponsavel)}" value="#{msg.apagar}" update="cadastro:formCadastro:Tcontato" />
											</p:column>
										</p:dataTable>
									</p:column>
								</p:row>
														
                			</p:panelGrid>
                		</p:tab>
                		
                		<p:tab title="#{msg.dadosPai}">
                			<p:panelGrid  styleClass="noborder centralize" >
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.nome}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.pai.nome}" id="nomePai"/>
									</p:column>
								
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.rg}" />
									</p:column>
									<p:column>
										<p:inputMask mask="9.999.999-9" value="#{alunoBean.pai.rg}" id="rgPai"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.cpf}" />
									</p:column>
									<p:column>
										<p:inputMask mask="999.999.999-99" value="#{alunoBean.pai.cpf}" id="cpfPai" >
											<p:ajax event="blur" listener="#{alunoBean.verificaCpfPai()}" process="@this" update=":cadastro:messageAluno" />
										</p:inputMask>
									</p:column>
								
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.escolaridade}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.pai.escolaridade}" id="escolaridadePai"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.profissao}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.pai.profissao}" id="profPai"/>
									</p:column>
							
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.localTrabalho}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.pai.localtrabalho}" id="jobPai"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.telComercial}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.pai.telefone}" id="comPai"/>
									</p:column>
								
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.celular}" />
									</p:column>
									<p:column>
										<p:inputText />
									</p:column>
								</p:row>
                			</p:panelGrid>
                		</p:tab>
                		
                		<p:tab title="#{msg.dadosMae}">
                			<p:panelGrid  styleClass="noborder centralize" >
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.nome}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.mae.nome}" id="nomeMae"/>
									</p:column>
							
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.rg}" />
									</p:column>
									<p:column>
										<p:inputMask mask="9.999.999-9" value="#{alunoBean.mae.rg}" id="rgMae"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.cpf}" />
									</p:column>
									<p:column>
										<p:inputMask mask="999.999.999-99" value="#{alunoBean.mae.cpf}" id="cpfMae">
											<p:ajax event="blur" listener="#{alunoBean.verificaCpfPai()}" process="@this" update=":cadastro:messageAluno" />
										</p:inputMask>
									</p:column>
							
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.escolaridade}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.mae.escolaridade}" id="escolaridadeMae"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.profissao}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.mae.profissao}" id="profMae"/>
									</p:column>
							
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.localTrabalho}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.mae.localtrabalho}" id="jobMae"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.telComercial}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.mae.telefone}" id="comMae"/>
									</p:column>
							
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.celular}" />
									</p:column>
									<p:column>
										<p:inputText />
									</p:column>
								</p:row>
                			</p:panelGrid>
                		</p:tab>
                		
                		<p:tab title="#{msg.endereco}">
                			<p:panelGrid  styleClass="noborder centralize" id="enderecoTab" >
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.cep}" />
									</p:column>
									<p:column>
										<p:inputMask mask="99.999-999" value="#{alunoBean.aluno.cep}" id="cep">
											<p:ajax event="valueChange" listener="#{alunoBean.buscaCEP()}"  process="@this" update=":cadastro:formCadastro:enderecoTab" 
													/>
										</p:inputMask>
									</p:column>
									
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.rua}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.rua}" id="rua"/>
									</p:column>
							
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.numero}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.numero}" id="numero"/>
									</p:column>
		
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.bairro}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.bairro}" id="bairro"/>
									</p:column>
								
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.cidade}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.cidade}" id="cidade">
											
										</p:inputText>
									</p:column>
								
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.estado}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.estado}" id="estado"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.telRes}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.telefone}" id="tel"/>
									</p:column>
								
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.email}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.email}" id="email"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column styleClass="labelForm">
										<h:outputText value="#{msg.religiao}" />
									</p:column>
									<p:column>
										<p:inputText value="#{alunoBean.aluno.religiao}" id="religiao"/>
									</p:column>
								</p:row>
								
								<p:row>
									<p:column />
									<p:column styleClass="labelForm">
										<p:commandButton value="#{msg.cancelar}" />
									</p:column>
									
									<p:column>
										<p:commandButton value="#{msg.salvar}" id="saveButton" ajax="false" action="#{alunoBean.salva()}"/>
									</p:column>
								</p:row>
                			</p:panelGrid>
                		</p:tab>
                	</p:tabView>
                </div>
					
					<p:dialog id="aluno" closable="true" widgetVar="aluno" width="600" height="500">
						
						<p:dataTable value="#{alunoBean.listAluno}" var="lstALuno" id="alunoTable" rowKey="#{lstALuno.matricula}" selection="#{alunoBean.alunoSelecionado}" selectionMode="single"
									 paginator="true" paginatorPosition="bottom" rows="10">
							<p:column width="250">
								<f:facet name="header">
									<h:outputText value="#{msg.nome}" />
								</f:facet>
								<h:outputText value="#{lstALuno.nome}"/>
							</p:column>
							
							<p:column width="100">
								<f:facet name="header">
									<h:outputText value="#{msg.matricula}" />
								</f:facet>
								<h:outputText value="#{lstALuno.matricula}"/>
							</p:column>
							
							<p:column width="100">
								<f:facet name="header">
									<h:outputText value="#{msg.turma}" />
								</f:facet>
								<h:outputText value="#{lstALuno.turma.descricao}"/>
							</p:column>
							
						</p:dataTable>						
						<p:commandButton value="#{msg.ok}" action="#{alunoBean.selecionaAluno()}" ajax="true" update="@form" />
						
					</p:dialog>
				</h:form>
			</div>
			</div>
			</div>
		</ui:define>
		<ui:define name="script">
			<script type="text/javascript">
			$(document).ready(function() {

				$('#cadastro\\:formCadastro\\:valor').maskMoney({thousands:'.', decimal:',', allowZero:true}); 
				
				var msg = '';
				
				$('#cadastro\\:formCadastro\\:saveButton').click(function() {
					if($('#cadastro\\:formCadastro\\:anoLetivo_input').val() == ""){
						$('#cadastro\\:formCadastro\\:anoLetivo_input').addClass('formError');
						msg = msg + '#{msg.anoLetivoError}'+'\n';
					} 

					if($('#cadastro\\:formCadastro\\:anoMatricula_input').val() == ""){
						$('#cadastro\\:formCadastro\\:anoMatricula_input').addClass('formError');
						msg = msg + '#{msg.anoMatriculaError}'+'\n';
					} 

					if($('#cadastro\\:formCadastro\\:nomeAluno').val() == ""){
						$('#cadastro\\:formCadastro\\:nomeAluno').addClass('formError');
						msg = msg + '#{msg.nomeAlunoError}'+'\n';
					} 
					
					if($('#cadastro\\:formCadastro\\:datanasc_input').val() == ""){
						$('#cadastro\\:formCadastro\\:datanasc_input').addClass('formError');
						msg = msg + '#{msg.datanascError}'+'\n';
					} 
					
					
					if($('#cadastro\\:formCadastro\\:modalidade_input').val() == ""){
						$('#cadastro\\:formCadastro\\:modalidade_input').addClass('formError');
						msg = msg + '#{msg.modalidadeError}'+'\n';
					} 
					
					if($('#cadastro\\:formCadastro\\:periodo_input').val() == ""){
						$('#cadastro\\:formCadastro\\:periodo_input').addClass('formError');
						msg = msg + '#{msg.periodoError}'+'\n';
					} 
					
					if($('#cadastro\\:formCadastro\\:nivel_input').val() == ""){
						$('#cadastro\\:formCadastro\\:nivel').addClass('formError');
						msg = msg + '#{msg.nivelError}'+'\n';
					} 
					
					if($('#cadastro\\:formCadastro\\:horario').val() == ""){
						$('#cadastro\\:formCadastro\\:horario').addClass('formError');
						msg = msg + '#{msg.horarioError}'+'\n';
					} 
					
					if($('#cadastro\\:formCadastro\\:valor').val() == ""){
						$('#cadastro\\:formCadastro\\:valor').addClass('formError');
						msg = msg + '#{msg.valorError}'+'\n';
					} 
					
					
					if(msg == ''){
						var teste = $('#cadastro\\:formCadastro\\:valor').maskMoney('unmasked')[0];
						$('#cadastro\\:formCadastro\\:valor').val(teste);
						return true;
					}else{
						alert(msg);
						msg = '';
						return false;
					}
				});
			});
				
			
			</script>
		</ui:define>
	</ui:composition>
	
</html>